// Generated by CoffeeScript 1.9.3
(function() {
  var _, coffeelint, through;

  _ = require('lodash');

  through = require('through2');

  coffeelint = require('coffeelint');

  coffeelint.reporter = require('coffeelint-stylish').reporter;

  coffeelint.configfinder = require('coffeelint/lib/configfinder');

  module.exports = function(file, overrideOptions) {
    var errorReport, fileOptions, options;
    if (overrideOptions == null) {
      overrideOptions = {};
    }
    errorReport = coffeelint.getErrorReport();
    fileOptions = coffeelint.configfinder.getConfig() || {};
    options = _.defaults(overrideOptions, fileOptions);
    return through(function(buf, enc, next) {
      var errors;
      if (file.substr(-7) === '.coffee') {
        errors = errorReport.lint(file, buf.toString(), options);
        if (errors.length !== 0) {
          coffeelint.reporter(file, errors);
          if (options.doEmitErrors && errorReport.hasError()) {
            next(new Error("coffeelint has errors"));
          }
          if (options.doEmitWarnings && _.any(errorReport.paths, function(p) {
            return pathHasWarning(p);
          })) {
            next(new Error("coffeelint has warnings"));
          }
        }
      }
      this.push(buf);
      return next();
    });
  };

}).call(this);
